/*!
  * @lib: Radixx
  * @version: 0.1.2
  * @author: Ifeora Okechukwu
  * @created: 30/12/2016
  *
  * All Rights Reserved 2016 - 2018.
  * Use, reproduction, distribution, and modification of this code is subject to the terms and
  * conditions of the MIT license, available at http://www.opensource.org/licenses/mit-license.php
  *
  * @desc: Implementation of Facebooks' Flux Architecture with a Twist.
  */

 
!function(t,e){"use strict";"object"==typeof exports&&"object"==typeof module?module.exports=e(t):"function"==typeof define&&define.amd?define("Radixx",[],function(){return e(t)}):"object"==typeof exports?exports.Radixx=e(t):t.Radixx=e(t)}("undefined"!=typeof process&&"[object process]"==={}.toString.call(process)||"undefined"!=typeof navigator&&"ReactNative"===navigator.product?global:"undefined"!=typeof window?window:self,function(t,e){var n={}.hasOwnProperty,r=(t.onbeforeunload,t.onunload),i=!1,o=function(t){},a=function(t){"click"===t.type&&(t.stopPropagation?t.stopPropagation():t.cancelBubble=!0)},c=function(t){return function(e){var n=window.currentFocusElement||e.explicitOriginalTarget||e.srcDocument&&e.srcDocument.activeElement||e.currentTarget&&e.currentTarget.document.activeElement||e.srcElement||e.target,r="Are you sure you want to leave this page ?",o="function"==typeof n.hasAttribute&&n.hasAttribute("data-href")&&n.getAttribute("data-href").indexOf(t.runtime.shutDownHref)>-1||"href"in n&&n.href.indexOf(t.runtime.shutDownHref)>-1,c=function(){i=c.lock};return c.lock=i=!0,beforeUnloadTimer=setTimeout(c,0),o?~e.type.indexOf("beforeunload")?e.returnValue=r:(_confirm=confirm(r),_confirm||a(e)):a(e),o?(c.lock=!1)||r:clearTimeout(beforeUnloadTimer)}},u=function(t){return function(e){i||setTimeout(function(){var n={};t.eachStore(function(t,e){var r=t.getTitle();n[r]=t.getState(),t.disconnect(),t.destroy(),e()}),o.call(t,n),"click"!=e.type&&r(e)},0)}},l={runtime:{spaMode:!0,shutDownHref:""},persistenceEnabled:!1,autoRehydrate:!1,universalCoverage:!1,localHostDev:!1},s=[].slice,f={typesMap:{number:Number,array:Array,object:Object,string:String,boolean:Boolean,date:Date,regexp:RegExp,function:Function},isOfType:function(t,e){return"function"==typeof(t=t.toLowerCase())?t(e):"string"==typeof t&&t in this.typesMap&&(/^string|function$/.test(typeof e)||Object(e)instanceof this.typesMap[t])}},p=function(t,r,i){i===e&&(i=null);for(var o in t)n.call(t,o)&&r.call(i,t[o],o,t)},h=function(t,e){var r={};for(var i in e)n.call(e,i)&&("object"==typeof e[i]&&null!==e[i]?r[i]=h(t[i],e[i]):t&&n.call(t,i)?r[i]=t[i]:r[i]=e[i]);return r},d=function(t,e,n){return function(){var r=s.call(arguments);return t.apply(n,e.concat(r))}};Array.prototype.forEach=Array.prototype.forEach||function(t,e){return p(this,t,e)},Array.prototype.reduceRight=Array.prototype.reduceRight||function(t){"use strict";if(null===this||void 0===this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof t)throw new TypeError(callback+" is not a function");var e,n=Object(this),r=(n.length>>>0)-1;if(arguments.length>=2)e=arguments[1];else{for(;r>=0&&!(r in n);)r--;if(r<0)throw new TypeError("Reduce of empty array with no initial value");e=n[r--]}for(;r>=0;r--)r in n&&(e=callback(e,n[r],r,n));return e},Function.prototype.bind=Function.prototype.bind||function(t){return d(this,[].slice(arguments,1),t)},function(t,n){"use strict";function r(r,i){var o;i=i||{bubbles:!1,cancelable:!1,detail:e};try{(o=n.createEvent("CustomEvent")).initCustomEvent(r,i.bubbles,i.cancelable,i.detail)}catch(e){(o=n.createEventObject(t.event)).cancelBubble=!i.bubbles,o.returnValue=!i.cancelable,"object"==typeof i.detail&&(o.detail=i.detail)}return o}try{new t.CustomEvent("test")}catch(e){r.prototype=Object.create(t.Event&&t.Event.prototype||{}),t.CustomEvent=null,t.CustomEvent=r}}(t,t.document),Object.create=Object.create||function(t,e){"use strict";if(null===t||!(t instanceof Object))throw TypeError("Object.create called on null or non-object argument");var r;function i(){}if(i.prototype=t,"object"==typeof e)for(r in e)n.call(e,r)&&(i[r]=e[r]);return new i},Object.keys=Object.keys||function(t){"use strict";if("object"==typeof t||"function"==typeof t){var e=[];for(var r in fuc)n.call(fuc,r)&&e.push(r);var i=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","prototypeIsEnumerable","constructor"];if(!ob.propertyIsEnumerable("toString"))for(var o=0;o<i.length;o++){var a=i[o];n.call(fuc,a)&&e.push(a)}return e}};var y=function(t){this.getTitle=function(){return t},this.toJSON=function(){return{title:t}},this.makeTrait=function(t){var e=s.call(arguments,1);return"function"==typeof t?(e.unshift(this),t.apply(null,e)):null},this.toString=function(){return"[object RadixxStore]"}},g=function(t){this.getId=function(){return t},this.toJSON=function(){return{id:t}},this.toString=function(){return"[object RadixxActionCreator]"}},$={STARTED:0,AWAIT:1,RESOLVED:2,REJECTED:3},v=function(t){var n,r,i,o,a,c,u=(c={},String(t).split(",").forEach(function(t){c[t]=!0}),c.savedData=!1,c),l=[],f=u.multiple&&[],h=function(t){for(u.savedData=!h.$decline&&u.save&&t,o=!0,a=!0,i=n||0,r=l.length,n=0;i<r;i++)setTimeout(d(l[i],t[1],t[0]),20);if(a=!1,f&&f.length)return h(f.shift());h.$decline=!1,u.savedData&&u.unpack&&(l.length=0)};return{add:function(){var t=0;if(l){var e=l.length;!function e(n){n.forEach(function(n){"function"==typeof n?t=l.push(n):n&&n.length&&"string"!=typeof n&&e(s.call(n))})}(s.call(arguments)),o&&u.join&&(n=e,r=t,h.$decline=!0,h(u.savedData),this.disable())}return t},hasFn:function(t){var e=!1;return p(l,function(n){"function"==typeof t&&t===n&&(e=!0)},this),e},hasList:function(){return!!l},fireWith:function(){if(l&&(!o||f)){var t=arguments.length&&s.call(arguments)||[null,0];a?f.push(t):h(t)}},disable:function(){u.savedData||(l=f=e)}}},m=function(){var t,e={resolve:["done","RESOLVED",v(["join","save"])],reject:["fail","REJECTED",v(["join","save"])],notify:["progress","AWAIT",v(["join","multiple"])]},r=this,i=Object.keys(e),o=function(t,n,i){var o="notify"!=t;return n.length||i?i?function(){return r.state>=0&&r.state<=1&&e[t][2].add.apply(r,s.call(arguments)),r}:function(){if(r.state>=0&&r.state<=1&&(r.state=$[e[t][1]]),e[t][2].fireWith(r===this?r:this,[].slice.call(arguments)),o)switch(e[n[0]][2].disable(),e[n[1]][2].disable(),t){case"reject":case"resolve":r.state=$[e[t][1]]}return!0}:e[t][2].fireWith},a=0,c=i.slice(),u={};for(t in e)n.call(e,t)&&(i.splice(a++,1),r[t]=o(t,i),r[t+"With"]=o(t,[]),u[e[t][0]]=o(t,[],!0),i=c.slice());return u.state=$.STARTED,u.always=function(){return this.done.apply(r,arguments).fail.apply(r,arguments)},u.promise=function(t){if(t&&"object"==typeof t&&!t.length){for(var e in u)n.call(u,e)&&(t[e]=u[e]);return t}return u},u.then=function(){var t;return[].slice.call(arguments).forEach(function(n,o){n="function"==typeof n&&n,r[e[i[o]][0]](function(){var e;try{e=n&&n.apply(this,arguments)}catch(t){e=this.reject(t)}finally{e&&"function"==typeof e.promise&&(t=e.promise())}})}),r.promise(t)},u.isResolved=function(){return!e.reject[2].hasList()},u.isRejected=function(){return!e.resolve[2].hasList()},u.pipe=u.then,u.promise(r),m.STARTED=$.STARTED,m.AWAITING=$.AWAIT,m.RESOLVED=$.RESOLVED,m.REJECTED=$.REJECTED,o=c=t=a=null,r instanceof m?r:new m},b=function(r){var i=null,o=r.top===r&&r.localStorage?r.localStorage:null,a=r.top===r&&r.sessionStorage?r.sessionStorage:r.opera&&!n.call(r,"opera")?r.opera.scriptStorage:{},s=r.document.documentMode||0,d=!1,y={},g=[],$={},v=[],b={},w={},S=[],E={},T={},A=function(t){if("getPrototypeOf"in Object)return Object.getPrototypeOf(t);if("__proto__"in t){if(!n.call(t,"__proto__"))return t.__proto__}else if("constructor"in t&&!n.call(t,"constructor"))return t.constructor.prototype;return t},x=function(t){return void 0==t},O=function(t,n,i,o){1!=t.$$history.length||t.$$initData||(t.$$initData=t.$$history[0]),t.$$history=t.$$history.slice(0,t.$$historyIndex+1);var a,c,u,l,s,f=!1;if(null===n?(f=null!==o?o.actionData:t.$$history[t.$$historyIndex],_.$$historyLocation=t.$$historyIndex):(f=t.call(n,o,i.get()),_.$$historyLocation=null),"boolean"==typeof f||f==e)throw new TypeError("Radixx: Application State unavailable after signal to Dispatcher");if(a=i.put(f),_.$$currentStoreTitle=a,null===o)return f;o.source,c=r.document,u="storesignal",l={url:r.location.href,key:a,newValue:f,source:r,aspect:o.actionKey,type:o.actionType},"target"in(s=new CustomEvent(u,{detail:l,cancelable:!0,bubbles:!1}))||!0!==s.cancelBubble||c.setCapture(!0),c["target"in s?"dispatchEvent":"fireEvent"].apply(c,"target"in s?[s]:["on"+u,s]),_.$$withAction=!0,t.$$history.push(f),t.$$historyIndex++,t.$$history.length>21&&t.$$history.unshift()},I=function(t){return String(location.origin+(t.localHostDev?":"+document.documentElement.id:""))},R=function(t){var e=o.getItem(t);return x(e)?String(Math.random()).replace(".","x_").substring(0,11):j(e)},j=function(t){if(x(t)||"null"===t)return null;try{return JSON.parse(t)}catch(e){return String(t)}},k=function(t){x(t)&&(t=null);try{return JSON.stringify(t)}catch(e){return String(t)}},D=function(t){p(t,function(t,e){new L(e).put(t)}),M(t,!0)},C=function(){var t,e,n,i,o={};if("key"in a&&"function"==typeof a.key)for(var c=0;c<a.length;c++)t=a.key(c),i=a.getItem(t),o[t]=j(i)||null;else for(c=0;c<v.length;c++)t=v[c],T[t]&&(e=r.name.indexOf(t),n=r.name.indexOf("|",e),i=(r.name.substring(e,n).split(":=:")||["",null])[1]),o[t]=j(i)||null;return o},L=function(t){return this.put=function(e){var n,i,o="remainingSpace"in a&&8===s;o&&"function"==typeof a.begin&&a.begin();try{a.setItem(t,k(e))}catch(o){T[t]&&(n=r.name.indexOf(t),i=r.name.indexOf("|",n),r.name=r.name.replace(r.name.substring(n,i),"")),""===r.name?r.name=t+":=:"+k(e)+"|":r.name+=t+":=:"+k(e)+"|",T[t]=1}return o&&"function"==typeof a.commit&&a.commit(),t},this.get=function(){var e,n,i;try{return j(a.getItem(t))||null}catch(o){return T[t]?(e=r.name.indexOf(t),n=r.name.indexOf("|",e),i=r.name.substring(e,n).split(":=:")||[0,0],j(i[1])||null):null}},this.del=function(){var e,n;try{return a.removeItem(t)}catch(i){return void(T[t]&&(e=r.name.indexOf(t),n=r.name.indexOf("|",e),r.name=r.name.replace(r.name.substring(e,n),""),delete T[t]))}},this},_=function(t){var e,n=null,r=_.$$tag;!0===arguments.callee.$$withAction&&(n=(e=O.$$redoActionsStack).lenth?e[e.length-1]:null,arguments.callee.$$withAction=null),x(r)||null===o||(o.setItem(r,k({state:t,action:n,title:arguments.callee.$$currentStoreTitle,historyLoc:arguments.callee.$$historyLocation})),arguments.callee.$$historyLocation=null)},M=function(t,e){var r,i;for(r in g)if(n.call(g,r)){if(i=g[r],e&&i.$$canOmit)continue;i.call(null,t)}},P=function(){var t=null,e=C();for(var r in w)n.call(w,r)&&((t=w[r]).isResolved()||t.resolve(),delete w[r]);S.length=0,M(e)},F=function(t){var e,n,r,i,c,u=arguments.callee.$$origin,l=arguments.callee.$$tag,s=null;"remainingSpace"in a&&(t.key=t.detail.key),o&&u!==t.key&&(c=j(o.getItem(l)),l===t.key&&x(c)||(n=c.state,e=c.action,r=c.title,i=parseInt(c.historyLoc),null!==e&&O.$$redoActionsStack.push(e),null!==i&&(s=b[r])&&(s.$$historyIndex=i,-1===i&&(s.$$history.length=0)),n&&setTimeout(D.bind(null,n),0)))},H=function(t){if(t=t||r.event,v.indexOf(t.detail.key)>-1){var e,n=t.detail.key;if(!x(b[n])){e=b[n].$$store_listeners;for(var i=0;i<e.length;i++)e[i].call($[n],t.detail.type,t.detail.aspect)}}};function V(){this.middlewares=[],O.$$undoActionsStack=[],O.$$redoActionsStack=[]}return V.prototype.updateAutoRehydrationState=function(){d=!0},V.prototype.getAutoRehydrationState=function(){return d},V.prototype.setMiddleware=function(t){if("function"==typeof t)return this.middlewares.push(t);throw new Error("Radixx: Inavlid Middleware Callback - Must be a Function with Parameters ( >= 2 )")},V.prototype.hasMiddleware=function(){return this.middlewares.length>0},V.prototype.initCatchers=function(t){if(t.autoRehydrate){if(!x(F.$$tag)&&o)var e=j(o.getItem(F.$$tag));e instanceof Object&&e.state&&(D(e.state),this.updateAutoRehydrationState())}r.document.addEventListener?(t.universalCoverage&&r.addEventListener("storage",F,!1),r.document.addEventListener("storesignal",H,!1)):r.document.attachEvent&&(t.universalCoverage&&r.document.attachEvent("onstorage",F),r.document.attachEvent("onstoresignal",H))},V.prototype.getRegistration=function(t){return n.call(b,t)?b[t]:{}},V.prototype.register=function(t,e,r){if(n.call(b,t)){if("$$history"in b[t]&&void 0===e.$$history){if(!$[t])throw new Error("Radixx: Cannot Overwrite existing store registration");e.$$history=b[t].$$history,e.$$historyIndex=b[t].$$historyIndex,e.$$store_listeners=b[t].$$store_listeners,b[t]=e}}else e.$$store_listeners=[],e.$$history=[r||[]],e.$$historyIndex=0,b[t]=e,v.push(t);return!0},V.prototype.watch=function(t){g.push(t)},V.prototype.setStoreListener=function(t,e){var n=t.getTitle();x(b[n])||"function"==typeof e&&($[n]=t,b[n].$$store_listeners.push(e))},V.prototype.unsetStoreListener=function(t,e){var n=t.getTitle();if(!x(b[n])&&"function"==typeof e){var r=b[n].$$store_listeners.indexOf(e);b[n].$$store_listeners.splice(r,1)}},V.prototype.signalUnique=function(t){if("hydrate"==t.source){r.setTimeout(P,0);var e=new L(t.target),n=b[t.target];O.$$redoActionsStack.length=0,O.$$redoActionsStack.push(t),n.$$history.length=0,n.historyIndex=-1,O.apply(null,[n,null,e,t])}},V.prototype.handleStoreMutation=function(t,e){if(e){var n=t.getTitle(),i={},o=this.getRegistration(n),a=new L(n);switch(e){case"undo":if(t.canUndo())return--o.$$historyIndex,i[n]=O.apply(null,[o,null,a,null]),r.setTimeout(M.bind(null,i),0),!0;break;case"redo":if(t.canRedo())return++o.$$historyIndex,i[n]=O.apply(null,[o,null,a,null]),r.setTimeout(M.bind(null,i),0),!0}return!1}},V.prototype.rebuildStateFromActions=function(){var t=O.$$redoActionsStack;p(t,function(t,e){var r,i;for(i in b)n.call(b,i)&&(r=new L(i),b[i].call(t,r.get()))},O)},V.prototype.signal=function(t){var e=null,i=function(t,e,r,i){var o,a=null;O.$$redoActionsStack.push(r);for(o in t)n.call(t,o)&&(a=new L(o),O.apply(null,[t[o],e.queueing,a,r]));return C()}.bind(null,b,this),o={createDispatchResolver:function(t){return i.bind(null,t)}},a=this.hasMiddleware();t.source in E&&(e=a?this.middlewares.concat(i).reduceRight(function(t,e){return e.bind(null,t)}):i,r.setTimeout(P,0),x(e)||e.apply(a?o:null,[t,C()]))},V.prototype.unregister=function(t){var e,n;x(b[t])||(e=b[t],$[t],e.$$store_listeners.length=0,e.$$store_listeners=null,e.$$historyIndex=-1,e.$$history.length=0,e.$$history=null,delete b[t],e=null,delete $[t],null,-1!=(n=v.indexOf(t))&&v.splice(n,1))},V.prototype.queueing={await:function(t,e){for(var n=-1,r=t.length+n,i=null;++n<r;)i=S.indexOf(t[n])>-1?w[t[n]]:w[t[n]]=new m,"function"==typeof e&&i.then(e)}},{getInstance:function(){return null===i&&(i=new V),i},eachStore:function(t,e,n){p(v,e.bind(n=[],$));var r=t,i=n.length-1,o=function(){return i>=0?Boolean(r.call(null,n[i--],o)):r=!0};o()},setActionVectors:function(t,e){var r=A(t),i=this.getInstance(),o=null;for(var a in e)n.call(e,a)&&(o=e[a],r[a]=this.createActionInterface(i,o));return t},createStoreInterface:function(t,e){return function(){var n,r,i,o=arguments.length?arguments[0]:null;if("setChangeListener"==e)return t.setStoreListener(this,o);if("unsetChangeListener"==e)return t.unsetStoreListener(this,o);if("getState"==e)return(r=new L(this.getTitle()).get())===null?(n=t.getRegistration(this.getTitle())).$$history.length&&n.$$history[0]:"string"==typeof o&&o in r?r[o]:r;if("destroy"==e)return i in $&&delete $[i],new L(this.getTitle()).del(),null;if("disconnect"==e)return t.unregister(this.getTitle());if("hydrate"==e){if(x(o))return;return t.signalUnique({source:e,target:this.getTitle(),actionData:o})}return"getQuerySchema"==e?{}:"setQuerySchema"==e||("canUndo"==e?0!=(n=t.getRegistration(this.getTitle())).$$historyIndex:"swapCallback"==e?t.register(this.getTitle(),o):"canRedo"==e?(n=t.getRegistration(this.getTitle())).$$historyIndex!==n.$$history.length-1:"undo"==e?t.handleStoreMutation(this,e):"redo"==e?t.handleStoreMutation(this,e):void 0)}},createActionInterface:function(t,e){if(!(e instanceof Object))throw new TypeError("Invalid Action Creator Vector, expected [object] but found ["+typeof e+"]");return function(n,r){var i=this.getId(),o=0;if(x(E[i])||E[i].actionTypes.push(e),e.actionDefinition instanceof Array){if(p(e.actionDefinition,function(t){o|=Number(f.isOfType(t,n))}),!o)throw new TypeError("Action Data Invalid for action: ["+e.type+"]")}else if(!f.isOfType(e.actionDefinition,n))throw new TypeError("Action Data Invalid for action: ["+e.type+"]");return t.signal({source:i,actionType:e.type,actionKey:r||null,actionData:n})}},watchDispatcher:function(t){this.getInstance().watch(t)},isAppStateAutoRehydrated:function(){return this.getInstance().getAutoRehydrationState()},mergeConfig:function(e,n){var i=this.getInstance();if((y=h(e,l)).universalCoverage&&(y.persistenceEnabled=!0),y.runtime.spaMode?"string"==typeof y.runtime.shutDownHref&&0!=y.runtime.shutDownHref.length&&(r.addEventListener?(document.documentElement.addEventListener("click",c(y),!1),document.addEventListener("click",u(n),!1)):(document.documentElement.attachEvent("onclick",c(y)),document.attachEvent("onclick",u(n),!1))):"string"==typeof y.runtime.shutDownHref&&0!=y.runtime.shutDownHref.length&&(t.onbeforeunload=c(y),t.onunload=u(n)),y.persistenceEnabled){var a=I(y),s=R(a);o.setItem(a,s),F.$$origin=a,F.$$tag=s,_.$$canOmit=!0,_.$$tag=s,n.onDispatch(_)}return i.initCatchers(y),y},purgePersistStore:function(){var t=I(y),e=R(t);o.removeItem(t),o.removeItem(e)},registerAction:function(){var t=Math.random().toString(16).substr(2,13);return E[t]={actionTypes:[]},t},makeAggregator:function(){return{notifyAllStores:function(){}}},setMiddlewareCallback:function(t){var e=this.getInstance();try{e.getMiddleware()}catch(n){e.setMiddleware(t)}},setStoreObserver:function(t,e,n){if("function"!=typeof e)return null;var r=A(t),i=this.getInstance(),o=t.getTitle(),a=null;i.register(o,e,n);for(var c=["setChangeListener","unsetChangeListener","getState","disconnect","getQuerySchema","canRedo","canUndo","swapCallback","undo","redo","hydrate","destroy"],u=0;u<c.length;u++)r[a=c[u]]=this.createStoreInterface(i,a)}}}(t);function w(){this.toString=function(){return"[object RadixxHub]"},this.Helpers={isEqual:function(t,e){if(t===e)return!0;if("object"!=typeof t||null===t||"object"!=typeof e||null===e)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(var i=hasOwnProperty.bind(e),o=0;o<n.length;o++)if(!i(n[o])||t[n[o]]!==e[n[o]])return!1}},this.Payload={type:{array:"array",date:"date",string:"string",regexp:"regexp",boolean:"boolean",function:"function",object:"object",number:"number",error:function(t){return t instanceof Error||t instanceof TypeError},nullable:function(t){return null===t||t===e},numeric:{Int:function(t){return isFinite(t)&&t===parseInt(t)},Float:function(t){return isFinite(t)&&t===parseFloat(t)}},any:function(t){return null!==t||t!==e}}}}return w.prototype.constructor=w,w.prototype.onShutdown=function(t){"function"==typeof t&&(o=t)},w.prototype.purgePersistentStorage=function(){b.purgePersistStore()},w.prototype.onDispatch=function(t){"function"==typeof t&&b.watchDispatcher(t)},w.prototype.requestAggregator=function(){return b.makeAggregator()},w.prototype.eachStore=function(t){return b.eachStore(t,function(t,e){this.push(t[e])},null)},w.prototype.makeActionCreators=function(t){var e=new function(t){g.apply(this,s.call(arguments))}(b.registerAction());return b.setActionVectors(e,t)},w.prototype.makeStore=function(t,e,n){var r=new function(){y.apply(this,s.call(arguments))}(t);return b.setStoreObserver(r,e,n),r},w.prototype.attachMiddleware=function(t){b.setMiddlewareCallback(t)},w.prototype.isAppStateAutoRehydrated=function(){return b.isAppStateAutoRehydrated()},w.prototype.configure=function(t){b.mergeConfig(t,this)},new w});
