/*!
  * @lib: Radixx
  * @version: 0.1.3
  * @author: Ifeora Okechukwu
  * @created: 30/12/2016
  *
  * All Rights Reserved 2016 - 2018.
  * Use, reproduction, distribution, and modification of this code is subject to the terms and
  * conditions of the MIT license, available at http://www.opensource.org/licenses/mit-license.php
  *
  * @desc: Implementation of Facebooks' Flux Architecture with a Twist.
  */
function Hub(){var n=null,t="object";this.toString=function(){return"[object RadixxHub]"},this.Helpers={isEqual:function(i,r){var u,e,o,f;if(i===r)return!0;if(typeof i!=t||i===n||typeof r!=t||r===n||(u=Object.keys(i),e=Object.keys(r),u.length!==e.length))return!1;for(o=hasOwnProperty.bind(r),f=0;f<u.length;f++)if(!o(u[f])||i[u[f]]!==r[u[f]])return!1}},this.Payload={type:{array:"array",date:"date",string:"string",regexp:"regexp",boolean:"boolean","function":"function",object:t,number:"number",error:function(n){return n instanceof Error||n instanceof TypeError},nullable:function(t){return t===n||t===undefined},numeric:{Int:function(n){return isFinite(n)&&n===parseInt(n)},Float:function(n){return isFinite(n)&&n===parseFloat(n)}},any:function(t){return t!==n||t!==undefined}}}}var wind=window||{},Hop={}.hasOwnProperty,__beforeunload=wind.onbeforeunload,__unload=wind.onunload,__hasDeactivated=!1,_ping=function(){return},_checkAndKillEventPropagation=function(n){n.type==="click"&&(n.stopPropagation?n.stopPropagation():n.cancelBubble=!0)},$createBeforeTearDownCallback=function(n){return function(t){var f="data-href",i=window.currentFocusElement||t.explicitOriginalTarget||t.srcDocument&&t.srcDocument.activeElement||t.currentTarget&&t.currentTarget.document.activeElement||t.srcElement||t.target,u="Are you sure you want to leave this page ?",e=typeof i.hasAttribute=="function"&&i.hasAttribute(f)&&i.getAttribute(f).indexOf(n.runtime.shutDownHref)>-1||"href"in i&&i.href.indexOf(n.runtime.shutDownHref)>-1,r=function(){__hasDeactivated=r.lock};return r.lock=__hasDeactivated=!0,beforeUnloadTimer=setTimeout(r,0),e?~t.type.indexOf("beforeunload")?t.returnValue=u:(_confirm=confirm(u),_confirm||_checkAndKillEventPropagation(t)):_checkAndKillEventPropagation(t),e?(r.lock=!1)||u:clearTimeout(beforeUnloadTimer)}},$createTearDownCallback=function(n){return function(t){__hasDeactivated||setTimeout(function(){var i={};n.eachStore(function(n,t){var r=n.getTitle();i[r]=n.getState(),n.disconnect(),n.destroy(),t()}),_ping.call(n,i),t.type!="click"&&__unload(t)},0)}},_defaultConfig={runtime:{spaMode:!0,shutDownHref:""},persistenceEnabled:!1,autoRehydrate:!1,universalCoverage:!1,localHostDev:!1},Slc=[].slice,Values={typesMap:{number:Number,array:Array,object:Object,string:String,boolean:Boolean,date:Date,regexp:RegExp,"function":Function},isOfType:function(n,t){return typeof n=="function"?n(t):typeof n=="string"&&n in this.typesMap?(n=n.toLowerCase(),/^string|function$/.test(typeof t)||Object(t)instanceof this.typesMap[n]):!1}},_each=function(n,t,i){i===undefined&&(i=null);for(var r in n)Hop.call(n,r)&&t.call(i,n[r],r,n)},_extend=function(n,t){var r={},i;for(i in t)Hop.call(t,i)&&(r[i]=typeof t[i]=="object"&&t[i]!==null?_extend(n[i],t[i]):n&&Hop.call(n,i)?n[i]:t[i]);return r},_curry=function(n,t,i){return function(){var r=Slc.call(arguments);return n.apply(i,t.concat(r))}};(function(n,t){"use strict";function i(i,r){var f,u;r=r||{bubbles:!1,cancelable:!1,detail:null};try{u=t.createEvent("CustomEvent"),u.initCustomEvent(i,r.bubbles,r.cancelable,r.detail)}catch(e){u=t.createEventObject(n.event),u.cancelBubble=!r.bubbles,u.returnValue=!r.cancelable,typeof r.detail=="object"&&(u.detail=r.detail)}return u}try{var r=new n.CustomEvent("test")}catch(u){i.prototype=Object.create(n.Event&&n.Event.prototype||{}),n.CustomEvent=null,n.CustomEvent=i}})(wind,wind.document);var Store=function(){var t=["graph-ql","rest"],i={},n={};return function(t){var i=this,r=i;i.getTitle=function(){return t},i.toJSON=function(){return{title:t}},i.makeTrait=function(n){var t=Slc.call(arguments,1);return typeof n=="function"?(t.unshift(this),n.apply(null,t)):null},i.waitsFor=function(){[].push.apply(n,Slc.call(arguments))},i.toString=function(){return"[object RadixxStore]"}}}(),Action=function(){return function(n){this.getId=function(){return n},this.toJSON=function(){return{id:n}},this.toString=function(){return"[object RadixxActionCreator]"}}}(),futuresStates={STARTED:0,AWAIT:1,RESOLVED:2,REJECTED:3},formatOptions=function(n){var t={},i=String(n).split(",");return i.forEach(function(n){t[n]=!0}),t.savedData=!1,t},Routines=function(n){var l="function",f=!0,i=formatOptions(n),o,s,e,h,c,t=[],r=i.multiple&&[],u=function(n){for(i.savedData=!u.$decline&&i.save&&n,h=f,c=f,e=o||0,s=t.length,o=0;e<s;e++)setTimeout(_curry(t[e],n[1],n[0]),20);if(c=!1,r&&r.length)return u(r.shift());u.$decline=!1,i.savedData&&i.unpack&&(t.length=0)};return{add:function(){var n=0,r;return t&&(r=t.length,function e(i){i.forEach(function(i){var r=typeof i;r==l?n=t.push(i):!!i&&i.length&&typeof i!="string"&&e(Slc.call(i))})}(Slc.call(arguments)),h&&i.join&&(o=r,s=n,u.$decline=f,u(i.savedData),this.disable())),n},hasFn:function(n){var i=!1;return _each(t,function(t){typeof n==l&&n===t&&(i=f)},this),i},hasList:function(){return!!t},fireWith:function(){if(t&&(!h||r)){var n=arguments.length&&Slc.call(arguments)||[null,0];c?r.push(n):u(n)}},disable:function(){i.savedData||(t=r=undefined)}}},Futures=function(){var e="join",t={resolve:["done","RESOLVED",Routines([e,"save"])],reject:["fail","REJECTED",Routines([e,"save"])],notify:["progress","AWAIT",Routines([e,"multiple"])]},n=this,u=Object.keys(t),f=function(i,r,u){var f=i!="notify";return!r.length&&!u?t[i][2].fireWith:u?function(){return n.state>=0&&n.state<=1&&t[i][2].add.apply(n,Slc.call(arguments)),n}:function(){if(n.state>=0&&n.state<=1&&(n.state=futuresStates[t[i][1]]),t[i][2].fireWith(n===this?n:this,[].slice.call(arguments)),f){t[r[0]][2].disable(),t[r[1]][2].disable();switch(i){case"reject":case"resolve":n.state=futuresStates[t[i][1]]}}return!0}},o=0,s=u.slice(),r,i={};for(r in t)Hop.call(t,r)&&(u.splice(o++,1),n[r]=f(r,u),n[r+"With"]=f(r,[]),i[t[r][0]]=f(r,[],!0),u=s.slice());return i.state=futuresStates.STARTED,i.always=function(){return this.done.apply(n,arguments).fail.apply(n,arguments)},i.promise=function(n){if(n&&typeof n=="object"&&!n.length){for(var t in i)Hop.call(i,t)&&(n[t]=i[t]);return n}return i},i.then=function(){var i,r=[].slice.call(arguments);return r.forEach(function(r,f){var e="function";r=typeof r==e&&r,n[t[u[f]][0]](function(){var n;try{n=r&&r.apply(this,arguments)}catch(t){n=this.reject(t)}finally{n&&typeof n.promise==e&&(i=n.promise())}})}),n.promise(i)},i.isResolved=function(){return!t.reject[2].hasList()},i.isRejected=function(){return!t.resolve[2].hasList()},i.pipe=i.then,i.promise(n),Futures.STARTED=futuresStates.STARTED,Futures.AWAITING=futuresStates.AWAIT,Futures.RESOLVED=futuresStates.RESOLVED,Futures.REJECTED=futuresStates.REJECTED,f=s=r=o=null,n instanceof Futures?n:new Futures},Observable=function(n){var bt="swapCallback",at="getQuerySchema",lt="disconnect",wt="getState",vt="unsetChangeListener",pt="setChangeListener",st="redo",ot="undo",yt="remainingSpace",tt=":=:",b="|",nt="string",a="function",kt="storesignal",it="hydrate",e=!0,h=!1,t=null;function r(){this.middlewares=[],s.$$undoActionsStack=[],s.$$redoActionsStack=[]}var ht=t,c=n.top!==n||!n.localStorage?t:n.localStorage,f=n.top!==n||!n.sessionStorage?n.opera&&!Hop.call(n,"opera")?n.opera.scriptStorage:{}:n.sessionStorage,oi=n.document.documentMode||0,dt=h,u={},rt=[],v={},y=[],i={},k={},gt=[],ut={},d={},ni=function(n){var t="constructor",i="__proto__";if("getPrototypeOf"in Object)return Object.getPrototypeOf(n);if(i in n){if(!Hop.call(n,i))return n.__proto__}else if(t in n&&!Hop.call(n,t))return n.constructor.prototype;return n},o=function(n){return n==void 0},si=function(n,t,i){var f="target",u=new CustomEvent(t,{detail:i,cancelable:e,bubbles:h}),o=function(){return h};return f in u||u.cancelBubble!==e||n.setCapture(e),o=n[f in u?"dispatchEvent":"fireEvent"],o.apply(n,f in u?[u]:["on"+t,u])},s=function(i,r,u,f){i.$$history.length!=1||i.$$initData||(i.$$initData=i.$$history[0]),i.$$history=i.$$history.slice(0,i.$$historyIndex+1);var o=h,c,s;if(r===t?(o=f!==t?f.actionData:i.$$history[i.$$historyIndex],l.$$historyLocation=i.$$historyIndex):o=i.call(r,f,u.get()||i.$$initData),typeof o=="boolean"||o==undefined){throw new TypeError("Radixx: Application State unavailable after signal to Dispatcher");return}if(s=u.put(o),l.$$currentStoreTitle=s,f!==t)f.source!==it,l.$$withAction=e,si(n.document,kt,{url:n.location.href,key:s,newValue:o,source:n,aspect:f.actionKey,type:f.actionType},n),c=i.$$history.push(o),i.$$historyIndex++,l.$$historyLocation=i.$$historyIndex,i.$$history.length>21&&i.$$history.unshift();else return l.$$historyLocation=i.$$historyIndex,o},ti=function(n){return String(location.origin+(n.localHostDev?":"+document.documentElement.id:""))},ii=function(n){var t=c.getItem(n);return o(t)?String(Math.random()).replace(".","x_").substring(0,11):p(t)},p=function(n){if(o(n)||n==="null")return t;try{return JSON.parse(n)}catch(i){return String(n)}},ft=function(n){o(n)&&(n=t);try{return JSON.stringify(n)}catch(i){return String(n)}},ri=function(n){_each(n,function(n,t){var i=new w(t);i.put(n)}),et(n,e)},ct=function(){var s={},e,u,h,c,l,r,o;if("key"in f&&typeof f.key==a)for(o=0;o<f.length;o++)u=f.key(o),r=f.getItem(u),r||(e=i[u],r=!!e&&e.$$history.length?e.$$history[0]:t),s[u]=typeof r==nt?p(r):r;else for(o=0;o<y.length;o++)u=y[o],d[u]?(h=n.name.indexOf(u),c=n.name.indexOf(b,h),l=n.name.substring(h,c).split(tt)||["",t],r=l[1]):(e=i[u],r=!!e&&e.$$history.length?e.$$history[0]:t),s[u]=typeof r==nt?p(r):r;return s},w=function(i){var r=this;return r.put=function(t){var r,u,e=yt in f&&oi===8;e&&typeof f.begin==a&&f.begin();try{f.setItem(i,ft(t))}catch(o){d[i]&&(r=n.name.indexOf(i),u=n.name.indexOf(b,r),n.name=n.name.replace(n.name.substring(r,u),"")),n.name===""?n.name=i+tt+ft(t)+b:n.name+=i+tt+ft(t)+b,d[i]=1}return e&&typeof f.commit==a&&f.commit(),i},r.get=function(){var r,u,e;try{return p(f.getItem(i))||t}catch(o){return d[i]?(r=n.name.indexOf(i),u=n.name.indexOf(b,r),e=n.name.substring(r,u).split(tt)||[0,0],p(e[1])||t):t}},r.del=function(){var t,r;try{return f.removeItem(i)}catch(u){d[i]&&(t=n.name.indexOf(i),r=n.name.indexOf(b,t),n.name=n.name.replace(n.name.substring(t,r),""),delete d[i]);return}},r},ui=function(n){var i=s.$$redoActionsStack;return i.length?typeof n!="number"?i[i.length-1]:i[n]:t},l=function(n){var i=t,r=l.$$tag;arguments.callee.$$withAction===e?(i=ui(),arguments.callee.$$withAction=t):i=ui(l.$$historyLocation),o(r)||c===t||(c.setItem(r,ft({state:n,action:i,title:arguments.callee.$$currentStoreTitle,historyLoc:arguments.callee.$$historyLocation})),arguments.callee.$$historyLocation=t)},et=function(n,i){var r,u;for(r in rt)if(Hop.call(rt,r)){if(u=rt[r],i&&u.$$canOmit)continue;u.call(t,n)}},fi=function(){var i=t,r=ct(),n;for(n in k)Hop.call(k,n)&&(i=k[n],i.isResolved()||i.resolve(),delete k[n]);gt.length=0,et(r)},g=function(n){var y=arguments.callee.$$origin,a=arguments.callee.$$tag,h=t,l=t,v=t,u=t,r=t,e=t;(yt in f&&(n.key=n.detail.key),c&&y!==n.key)&&((r=p(c.getItem(a)),a===n.key&&o(r))||(l=r.state,h=r.action,v=r.title,u=parseInt(r.historyLoc),h!==t&&s.$$redoActionsStack.push(h),u!==t&&(e=i[v],e&&(e.$$historyIndex=u,u===-1&&(e.$$history.length=0))),l&&setTimeout(ri.bind(t,l),0)))},ei=function(t){var r,f,u;if(t=t||n.event,y.indexOf(t.detail.key)>-1&&(r=t.detail.key,!o(i[r])))for(f=i[r].$$store_listeners,u=0;u<f.length;u++)f[u].call(v[r],t.detail.type,t.detail.aspect)};return r.prototype.updateAutoRehydrationState=function(){dt=e},r.prototype.getAutoRehydrationState=function(){return dt},r.prototype.setMiddleware=function(n){if(typeof n==a)return this.middlewares.push(n);throw new Error("Radixx: Inavlid Middleware Callback - Must be a Function with Parameters ( >= 2 )");},r.prototype.hasMiddleware=function(){return this.middlewares.length>0},r.prototype.initCatchers=function(t){if(t.autoRehydrate){if(!o(g.$$tag)&&c)var i=p(c.getItem(g.$$tag));i instanceof Object&&i.state&&(ri(i.state),this.updateAutoRehydrationState())}n.document.addEventListener?(t.universalCoverage&&n.addEventListener("storage",g,h),n.document.addEventListener(kt,ei,h)):n.document.attachEvent&&(t.universalCoverage&&n.document.attachEvent("onstorage",g),n.document.attachEvent("onstoresignal",ei))},r.prototype.getRegistration=function(n){return Hop.call(i,n)?i[n]:{}},r.prototype.register=function(n,r,u){if(Hop.call(i,n)){if("$$history"in i[n]&&typeof r.$$history=="undefined"){if(!v[n]){throw new Error("Radixx: Cannot Overwrite existing store registration");return}r.$$history=i[n].$$history,r.$$historyIndex=i[n].$$historyIndex,r.$$store_listeners=i[n].$$store_listeners,i[n]=r}}else r.$$store_listeners=[],r.$$history=[!u?t:u],r.$$historyIndex=0,i[n]=r,y.push(n);return e},r.prototype.watch=function(n){rt.push(n)},r.prototype.setStoreListener=function(n,t){var r=n.getTitle();o(i[r])||typeof t==a&&(v[r]=n,i[r].$$store_listeners.push(t))},r.prototype.unsetStoreListener=function(n,t){var r=n.getTitle(),u;o(i[r])||typeof t==a&&(u=i[r].$$store_listeners.indexOf(t),i[r].$$store_listeners.splice(u,1))},r.prototype.signalUnique=function(r){if(r.source==it){n.setTimeout(fi,0);var f=new w(r.target),u=i[r.target];s.$$redoActionsStack.length=0,s.$$redoActionsStack.push(r),u.$$history.length=0,u.historyIndex=-1,s.apply(t,[u,t,f,r])}},r.prototype.handleStoreMutation=function(i,r){if(r){var u=i.getTitle(),f={},o=this.getRegistration(u),c=new w(u);switch(r){case ot:if(i.canUndo())return--o.$$historyIndex,f[u]=s.apply(t,[o,t,c,t]),n.setTimeout(et.bind(t,f),0),e;break;case st:if(i.canRedo())return++o.$$historyIndex,f[u]=s.apply(t,[o,t,c,t]),n.setTimeout(et.bind(t,f),0),e}return h}},r.prototype.rebuildStateFromActions=function(){var n=s.$$redoActionsStack;_each(n,function(n){var u,r;for(r in i)Hop.call(i,r)&&(u=new w(r),i[r].call(n,u.get()))},s)},r.prototype.signal=function(r){var u=t,h=function(n,i,r){var f,e=t;s.$$redoActionsStack.push(r);for(f in n)Hop.call(n,f)&&(e=new w(f),s.apply(t,[n[f],i.queueing,e,r]));return ct()},f=h.bind(t,i,this),c={createDispatchResolver:function(n){return f.bind(t,n)}},e=this.hasMiddleware();r.source in ut&&(u=e?this.middlewares.concat(f).reduceRight(function(n,i){return i.bind(t,n)}):f,n.setTimeout(fi,0),o(u)||u.apply(e?c:t,[r,ct()]))},r.prototype.unregister=function(n){var r,f,u;o(i[n])||(r=i[n],f=v[n],r.$$store_listeners.length=0,r.$$store_listeners=t,r.$$historyIndex=-1,r.$$history.length=0,r.$$history=t,delete i[n],r=t,delete v[n],f=t,u=y.indexOf(n),u!=-1&&y.splice(u,1))},r.prototype.queueing={await:function(n,i){for(var r=-1,f=n.length+r,u=t;++r<f;)u=gt.indexOf(n[r])>-1?k[n[r]]:k[n[r]]=new Futures,typeof i==a&&u.then(i)}},{getInstance:function(){return ht===t&&(ht=new r),ht},eachStore:function(n,i,r){_each(y,i.bind(r=[],v));var u=n,f=r.length-1,e=function(){var n;return f>=0?n=Boolean(u.call(t,r[f--],e)):(u=!0,n=u),n};e()},setActionVectors:function(n,i){var f=ni(n),e=this.getInstance(),u=t,r;for(r in i)Hop.call(i,r)&&(u=i[r],f[r]=this.createActionInterface(e,u));return n},createStoreInterface:function(n,i){return function(){var r=this,u,h,f=arguments.length?arguments[0]:t,s,c,l;return i==pt?n.setStoreListener(r,f):i==vt?n.unsetStoreListener(r,f):i==wt?(c=r.getTitle(),h=new w(c),s=h.get(),h=t,s===t?(u=n.getRegistration(c),s=u.$$history.length?u.$$history[0]:t):typeof f==nt&&s instanceof Object&&Hop.call(s,f)&&(s=s[f]),s):i=="destroy"?(c in v&&delete v[c],h=new w(r.getTitle()),h.del(),h=c=t):i==lt?n.unregister(r.getTitle()):i==it?o(f)?void 0:n.signalUnique({source:i,target:r.getTitle(),actionData:f}):i==at?{}:i=="setQuerySchema"?e:i=="canUndo"?(u=n.getRegistration(r.getTitle()),u.$$historyIndex!=0):i==bt?n.register(r.getTitle(),f):i=="canRedo"?(u=n.getRegistration(r.getTitle()),u.$$historyIndex!==u.$$history.length-1):i==ot?n.handleStoreMutation(r,i):i==st?n.handleStoreMutation(r,i):void 0}},createActionInterface:function(n,i){if(!(i instanceof Object))throw new TypeError("Invalid Action Creator Vector, expected [object] but found ["+typeof i+"]");return function(r,u){var e="Action Data Invalid for action: [",f=this.getId(),s=0;if(o(ut[f])||ut[f].actionTypes.push(i),i.actionDefinition instanceof Array){if(_each(i.actionDefinition,function(n){s|=Number(Values.isOfType(n,r))}),!s)throw new TypeError(e+i.type+"]");}else if(!Values.isOfType(i.actionDefinition,r))throw new TypeError(e+i.type+"]");return n.signal({source:f,actionType:i.type,actionKey:u||t,actionData:r})}},watchDispatcher:function(n){var t=this.getInstance();t.watch(n)},isAppStateAutoRehydrated:function(){var n=this.getInstance();return n.getAutoRehydrationState()},mergeConfig:function(t,i){var o=this.getInstance(),r,f;if(u=_extend(t,_defaultConfig),u.universalCoverage&&(u.persistenceEnabled=e),u.runtime.spaMode?typeof u.runtime.shutDownHref==nt&&u.runtime.shutDownHref.length!=0&&(n.addEventListener?(document.documentElement.addEventListener("click",$createBeforeTearDownCallback(u),h),document.addEventListener("click",$createTearDownCallback(i),h)):(document.documentElement.attachEvent("onclick",$createBeforeTearDownCallback(u)),document.attachEvent("onclick",$createTearDownCallback(i),h))):typeof u.runtime.shutDownHref==nt&&u.runtime.shutDownHref.length!=0&&(wind.onbeforeunload=$createBeforeTearDownCallback(u),wind.onunload=$createTearDownCallback(i)),u.persistenceEnabled){r=ti(u),f=ii(r),c.setItem(r,f),g.$$origin=r,g.$$tag=f,l.$$canOmit=e,l.$$tag=f;i.onDispatch(l)}return o.initCatchers(u),u},purgePersistStore:function(){var n=ti(u),t=ii(n);c.removeItem(n),c.removeItem(t)},registerAction:function(){var n=Math.random().toString(16).substr(2,13);return ut[n]={actionTypes:[]},n},makeAggregator:function(){return{notifyAllStores:function(){}}},setMiddlewareCallback:function(n){var t=this.getInstance();try{t.getMiddleware()}catch(i){t.setMiddleware(n)}},setStoreObserver:function(n,i,r){var e,u;if(typeof i!=a)return t;var s=ni(n),o=this.getInstance(),h=n.getTitle(),f=t;for(o.register(h,i,r),e=[pt,vt,wt,lt,at,"canRedo","canUndo",bt,ot,st,it,"destroy"],u=0;u<e.length;u++)f=e[u],s[f]=this.createStoreInterface(o,f)}}}(wind);Hub.prototype.constructor=Hub,Hub.prototype.onShutdown=function(n){typeof n=="function"&&(_ping=n)},Hub.prototype.purgePersistentStorage=function(){Observable.purgePersistStore()},Hub.prototype.onDispatch=function(n){typeof n=="function"&&Observable.watchDispatcher(n)},Hub.prototype.requestAggregator=function(){return Observable.makeAggregator()},Hub.prototype.eachStore=function(n){return Observable.eachStore(n,function(n,t){this.push(n[t])},null)},Hub.prototype.makeActionCreators=function(n){function t(){Action.apply(this,Slc.call(arguments))}var i=new t(Observable.registerAction());return Observable.setActionVectors(i,n)},Hub.prototype.makeStore=function(n,t,i){function u(){Store.apply(this,Slc.call(arguments))}var r=new u(n);return Observable.setStoreObserver(r,t,i),r},Hub.prototype.attachMiddleware=function(n){Observable.setMiddlewareCallback(n)},Hub.prototype.isAppStateAutoRehydrated=function(){return Observable.isAppStateAutoRehydrated()},Hub.prototype.configure=function(n){Observable.mergeConfig(n,this)},module.exports=new Hub